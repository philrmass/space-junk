(()=>{"use strict";var o="undefined"!=typeof Float32Array?Float32Array:Array;function e(){var e=new o(16);return o!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function r({width:o,height:r}){const t=e();var n,a,i,c,s,u;a=t,c=(i=[2/o,2/r,1])[0],s=i[1],u=i[2],(n=t)[0]=a[0]*c,n[1]=a[1]*c,n[2]=a[2]*c,n[3]=a[3]*c,n[4]=a[4]*s,n[5]=a[5]*s,n[6]=a[6]*s,n[7]=a[7]*s,n[8]=a[8]*u,n[9]=a[9]*u,n[10]=a[10]*u,n[11]=a[11]*u,n[12]=a[12],n[13]=a[13],n[14]=a[14],n[15]=a[15];const d=e();return function(o,e,r){var t,n,a,i,c,s,u,d,m,l,f,g,p=r[0],h=r[1],A=r[2];e===o?(o[12]=e[0]*p+e[4]*h+e[8]*A+e[12],o[13]=e[1]*p+e[5]*h+e[9]*A+e[13],o[14]=e[2]*p+e[6]*h+e[10]*A+e[14],o[15]=e[3]*p+e[7]*h+e[11]*A+e[15]):(t=e[0],n=e[1],a=e[2],i=e[3],c=e[4],s=e[5],u=e[6],d=e[7],m=e[8],l=e[9],f=e[10],g=e[11],o[0]=t,o[1]=n,o[2]=a,o[3]=i,o[4]=c,o[5]=s,o[6]=u,o[7]=d,o[8]=m,o[9]=l,o[10]=f,o[11]=g,o[12]=t*p+c*h+m*A+e[12],o[13]=n*p+s*h+l*A+e[13],o[14]=a*p+u*h+f*A+e[14],o[15]=i*p+d*h+g*A+e[15])}(t,t,[-o/2,-r/2,0]),{modelview:t,projection:d}}function t(o,e,r){const{modelview:t,projection:n}=e,a=o.getUniformLocation(r,r.modelviewName),i=o.getUniformLocation(r,r.projectionName);o.uniformMatrix4fv(a,!1,t),o.uniformMatrix4fv(i,!1,n)}function n(o,e,r){const t=o.getAttribLocation(r,r.positionName),n=o.getAttribLocation(r,r.colorName),a=o.getAttribLocation(r,r.coordName);t>=0&&(o.bindBuffer(o.ARRAY_BUFFER,e.position.buf),o.vertexAttribPointer(t,e.position.size,o.FLOAT,!1,0,0),o.enableVertexAttribArray(t)),n>=0&&(o.bindBuffer(o.ARRAY_BUFFER,e.color.buf),o.vertexAttribPointer(n,e.color.size,o.FLOAT,!1,0,0),o.enableVertexAttribArray(n)),a>=0&&(o.bindBuffer(o.ARRAY_BUFFER,e.coord.buf),o.vertexAttribPointer(a,e.coord.size,o.FLOAT,!1,0,0),o.enableVertexAttribArray(a))}function a(o,e,r){let t=o[e]+r;return t<0&&(t+=1),t>1&&(t-=1),[...o.slice(0,e),t,...o.slice(e+1)]}function i(o,e,r,t,n){const a=o.createShader(o.VERTEX_SHADER),i=o.createShader(o.FRAGMENT_SHADER);if(o.shaderSource(a,r),o.shaderSource(i,t),!a||!i)return null;const c=o.createProgram();return o.attachShader(c,a),o.attachShader(c,i),{name:e,prog:c,vs:a,fs:i,...n}}function c(o,e){e.compiled||(o.compileShader(e),e.compiled=!0)}Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var o=0,e=arguments.length;e--;)o+=arguments[e]*arguments[e];return Math.sqrt(o)});const s={positionName:"pos0",colorName:"col0",modelviewName:"modelview",projectionName:"projection"},u={positionName:"pos0",coordName:"crd0",modelviewName:"modelview",projectionName:"projection",samplerName:"sampler0"};window.onload=function(){let o=function(){const o=function(){const o=document.getElementById("canvas").getContext("webgl2");return o.canvas.style.position="absolute",o.canvas.style.top="0",o.canvas.style.left="0",o}(),e=function(o){const e=[];return e.push({name:"bombBoss",image:"space-junk/e2da941e663f76297147b7176e94f959.png"}),e.push({name:"spaceJunk",image:"space-junk/7c29e0d6a2f36968586e1ddbaad89ae0.png"}),e.reduce(((e,r)=>{const t=function(o,e){const r=o.createTexture();if(e){const t=new Image;t.onload=function(){o.bindTexture(o.TEXTURE_2D,r),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,1),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,t),o.generateMipmap(o.TEXTURE_2D)},t.src=e}return r}(o,r.image);return{...e,[r.name]:t}}),{})}(o),r=function(o){const e=[];e.push(i(o,"color","\nattribute vec4 pos0;\nattribute vec4 col0;\nuniform mat4 modelview;\nuniform mat4 projection;\nvarying lowp vec4 vfCol0;\n\nvoid main() {\n  gl_Position = projection * modelview * pos0;\n  gl_PointSize = 2.0;\n  vfCol0 = col0;\n}\n","\nvarying lowp vec4 vfCol0;\n\nvoid main() {\n  gl_FragColor = vfCol0;\n}\n",s)),e.push(i(o,"texture","\nattribute vec4 pos0;\nattribute vec2 crd0;\nuniform mat4 modelview;\nuniform mat4 projection;\nvarying mediump vec2 vfCrd0;\n\nvoid main() {\n  gl_Position = projection * modelview * pos0;\n  vfCrd0 = crd0;\n}\n","\nvarying mediump vec2 vfCrd0;\nuniform sampler2D sampler0;\n\nvoid main() {\n  gl_FragColor = texture2D(sampler0, vfCrd0);\n}\n",u));const r=function(o,e){for(const{vs:r,fs:t}of e)c(o,r),c(o,t);for(const{prog:r}of e)o.linkProgram(r);for(const{prog:r,vs:t,fs:n}of e)o.getProgramParameter(r,o.LINK_STATUS)||(console.error(`Link error: ${o.getProgramInfoLog(r)}`),console.error(`  vs log: ${o.getShaderInfoLog(t)}`),console.error(`  fs log: ${o.getShaderInfoLog(n)}`));for(const o of e)o.prog.positionName=o.positionName,o.prog.colorName=o.colorName,o.prog.coordName=o.coordName,o.prog.coordName=o.coordName,o.prog.modelviewName=o.modelviewName,o.prog.projectionName=o.projectionName,o.prog.samplerName=o.samplerName;for(const{vs:r,fs:t}of e)o.deleteShader(r),o.deleteShader(t);return e.map((({name:o,prog:e})=>({[o]:e})))}(o,e);return r.reduce(((o,e)=>({...o,...e})),{})}(o);return{gl:o,textures:e,programs:r,background:{width:window.innerWidth,height:window.innerHeight,color:[0,0,0]},characters:{spaceJunk:{x:100,y:100,width:50,height:150,program:"texture",texture:"spaceJunk"},bombBoss:{x:0,y:200,width:200,height:200,program:"texture",texture:"bombBoss"}}}}();const e=function(){let o=0,e=0,r=[];return window.onkeydown=o=>{r.push(o.key)},t=>{o+=1;const n=document.hasFocus(),a=t-e;e=t;const i=r;return r=[],{frame:o,hasFocus:n,dt:a,keys:i}}}();window.requestAnimationFrame((function i(c){const s=e(c);o=function(o,e){const r=function({gl:o}){return o.canvas.width=window.innerWidth,o.canvas.height=window.innerHeight,o}(o),t=o.textures,n=o.programs,i=function({gl:o,background:e}){const r=o.canvas.width,t=o.canvas.height,n=Date.now();let i=e.color;const c=.001,s=16&n?1:0,u=8&n?1:0,d=4&n?1:0,m=s+u+d+1e-14;return i=a(i,0,c*(s/m)),i=a(i,1,c*(u/m)),i=a(i,2,c*(d/m)),{width:r,height:t,color:i}}(o),c=function(o,e){const r=function({characters:o,background:e},{hasFocus:r,keys:t}){const{spaceJunk:n}=o;return t.length>0&&console.log(`KEYS: [${t}]`),r&&(t.length>0&&("ArrowRight"===t[0]?n.x=n.x+5:"ArrowLeft"===t[0]?n.x=n.x-5:"ArrowUp"===t[0]?n.y=n.y+5:"ArrowDown"===t[0]&&(n.y=n.y-5)),n.x>e.width&&(n.x-=e.width),n.y>e.height&&(n.y-=e.height)),n}(o,e);return{bombBoss:function({characters:o,background:e},{hasFocus:r}){const{bombBoss:t}=o;return r&&(t.x=t.x+5,t.y=t.y+5,t.x>e.width&&(t.x-=e.width),t.y>e.height&&(t.y-=e.height)),t}(o,e),spaceJunk:r}}(o,e);return{gl:r,textures:t,programs:n,background:i,characters:c}}(o,s),function(o){const{gl:e,textures:a,programs:i}=o,c=e.createVertexArray();e.bindVertexArray(c),function({gl:o,background:e}){o.clearColor(...e.color,1),o.clear(o.COLOR_BUFFER_BIT)}(o);const s=function({gl:o,characters:e}){const{bombBoss:r,spaceJunk:t}=e,n=[r,t].map((o=>function(o){const{x:e,y:r,width:t,height:n}=o;return{position:{size:2,data:[e,r,e+t,r,e,r+n,e+t,r+n]},color:{size:4,data:[1,0,0,0,1,.5,0,.8,1,1,0,.8,.5,1,0,.8]},coord:{size:2,data:[0,0,1,0,0,1,1,1]},texture:o.texture,program:o.program}}(o))).map((e=>function(o,e){const r={};if(e.position){const t=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,t),o.bufferData(o.ARRAY_BUFFER,new Float32Array(e.position.data),o.STATIC_DRAW);const n=e.position.data.length/e.position.size;r.position={buf:t,count:n}}if(e.color){const t=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,t),o.bufferData(o.ARRAY_BUFFER,new Float32Array(e.color.data),o.STATIC_DRAW);const n=e.color.data.length/e.color.size;r.color={buf:t,count:n}}if(e.coord){const t=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,t),o.bufferData(o.ARRAY_BUFFER,new Float32Array(e.coord.data),o.STATIC_DRAW);const n=e.coord.data.length/e.coord.size;r.coord={buf:t,count:n}}return{position:{...e.position,...r.position},color:{...e.color,...r.color},coord:{...e.coord,...r.coord},texture:e.texture,program:e.program}}(o,e)));return n}(o);for(const c of s){const s=r(o.background),u=a[c.texture],d=i[c.program],m=e.getUniformLocation(d,d.samplerName);e.useProgram(d),t(e,s,d),n(e,c,d),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,u),e.uniform1i(m,0),e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.viewport(0,0,e.canvas.clientWidth,e.canvas.clientHeight),e.drawArrays(e.TRIANGLE_STRIP,0,c.position.count)}}(o),window.requestAnimationFrame(i)}))}})();